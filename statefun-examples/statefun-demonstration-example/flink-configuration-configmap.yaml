apiVersion: v1
kind: ConfigMap
metadata:
  name: flink-config
  labels:
    app: flink
data:
  flink-conf.yaml: |+

    #==============================================================================
    # Configurations strictly required by Stateful Functions. Do not change.
    #==============================================================================
    classloader.parent-first-patterns.additional: org.apache.flink.statefun;org.apache.kafka;com.google.protobuf

    #==============================================================================
    # Recommended configurations. Users may change according to their needs.
    #==============================================================================
    state.backend: rocksdb
    state.backend.rocksdb.timer-service.factory: ROCKSDB
    state.checkpoints.dir: file:///checkpoint-dir
    state.backend.incremental: true
    taskmanager.memory.process.size: 4g

    taskmanager.numberOfTaskSlots: 2
    parallelism.default: 2
  log4j-console.properties: |+
    log4j.rootLogger=INFO, console

    log4j.logger.akka=INFO
    log4j.logger.org.apache.kafka=INFO
    log4j.logger.org.apache.hadoop=INFO
    log4j.logger.org.apache.zookeeper=INFO

    # Log all infos to the console
    log4j.appender.console=org.apache.log4j.ConsoleAppender
    log4j.appender.console.layout=org.apache.log4j.PatternLayout
    log4j.appender.console.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %-60c %x - %m%n

    # Suppress the irrelevant (wrong) warnings from the Netty channel handler
    log4j.logger.org.apache.flink.shaded.akka.org.jboss.netty.channel.DefaultChannelPipeline=ERROR, console